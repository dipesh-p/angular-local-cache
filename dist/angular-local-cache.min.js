/**
 * @author Dipesh Patel <masterdipesh@gmail.com>
 * @file angular-local-cache-0.0.1.js
 * @version 0.0.1 - Homepage <https://github.com/masterdipesh/angular-local-cache/>
 * @copyright (c) 2014 Dipesh Patel <https://github.com/masterdipesh/angular-local-cache>
 * @license MIT <https://github.com/masterdipesh/angular-local-cache/wiki/LICENSE>
 *
 * @overview AngularJS Module to support local cache supporting the expiry of individual key.
 */
var AngularLocalCache=angular.module("$ngLocalCache",[]);AngularLocalCache.provider("$ngLocalCache",function(){function r(){for(var r=0;r<localStorage.length;r++){var i=localStorage.key(r);n.push(i.replace(e.keyPrefix+"-",""));t[i.replace(e.keyPrefix+"-","")]=JSON.parse(localStorage.getItem(i))}}var e={keyPrefix:"ngLC",capacity:100,defaultMaxAge:9e5,recycleFrequency:6e4};this.setCacheOptions=function(t){for(key in t)if(e[key]!=undefined)e[key]=t[key]};var t={};var n=[];r();this.$get=["$timeout",function(r){r(i,e.recycleFrequency);var i=function(){var s=(new Date).getTime();for(var o in n){if(t[n[o]].expire_at<=s){delete t[n[o]];delete n[o];localStorage.removeItem(e.keyPrefix+"-"+n[o])}}r(i,e.recycleFrequency)};var s=function(){try{var t="localStorage"in window&&window["localStorage"]!==null;var n=e.keyPrefix+"__"+Math.round(Math.random()*1e7);if(t){localStorage.setItem(n,"");localStorage.removeItem(n)}return t}catch(r){return false}};var o=function(){try{return navigator.cookieEnabled||"cookie"in document&&(document.cookie.length>0||(document.cookie="test").indexOf.call(document.cookie,"test")>-1)}catch(e){return false}};var u=function(r,i,o){if(o==undefined)o=e.defaultMaxAge;if(t.length>=e.capacity){delete t[n[0]];if(s())localStorage.removeItem(e.keyPrefix+"-"+n[0]);delete n[0]}t[r]={data:i,expire_at:(new Date).getTime()+o};n.push(r);if(s()){localStorage.setItem(e.keyPrefix+"-"+r,JSON.stringify(t[r]))}return true};var a=function(e){if(t[e]!=undefined){if(t[e].expire_at>(new Date).getTime())return t[e].data;else return null}return null};var f=function(r){for(ind in n){if(n[ind]==r){delete n[ind]}}delete t[r];if(s())localStorage.removeItem(e.keyPrefix+"-"+r);return true};return{get:a,put:u,"delete":f}}]})